import socket
import sys

def check_cve_2021_40438(target_ip):
    try:
        with socket.create_connection((target_ip, 80), timeout=5) as sock:
            request = (
                f"GET / HTTP/1.1\r\n"
                f"Host: {target_ip}\r\n"
                f"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\r\n"
                f"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
                f"Accept-Language: en-US,en;q=0.5\r\n"
                f"Accept-Encoding: gzip, deflate\r\n"
                f"Connection: close\r\n"
                f"Upgrade-Insecure-Requests: 1\r\n"
                f"If-Modified-Since: Fri, 01 Jan 2021 00:00:00 GMT\r\n"
                f"If-None-Match: \"test\"\r\n\r\n"
            )
            sock.sendall(request.encode())
            response = sock.recv(4096)
            return b"Apache/2.4.48" in response and b"404" in response
    except (socket.timeout, ConnectionRefusedError, OSError):
        return False

if __name__ == "__main__":
    target = sys.argv[1]
    result = check_cve_2021_40438(target)
    print(result)