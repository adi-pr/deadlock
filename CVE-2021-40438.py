import http.client
import sys

def check_cve_2021_40438(target_ip):
    try:
        conn = http.client.HTTPConnection(target_ip, 80, timeout=5)
        headers = {
            "Host": target_ip,
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36",
            "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
            "Accept-Language": "en-US,en;q=0.5",
            "Accept-Encoding": "gzip, deflate",
            "Connection": "close",
            "Upgrade-Insecure-Requests": "1",
            "If-Modified-Since": "Fri, 01 Jan 2021 00:00:00 GMT",
            "If-None-Match": '"test"'
        }
        conn.request("GET", "/", headers=headers)
        response = conn.getresponse()
        data = response.read()
        conn.close()
        if b"Apache/2.4.48" in data and response.status == 404:
            return True
        return False
    except Exception:
        return False

if __name__ == "__main__":
    target = sys.argv[1]
    result = check_cve_2021_40438(target)
    print(result)